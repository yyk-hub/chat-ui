<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Customer Service Chat</title>
<style>
:root {
  --bg:#ffffff;
  --card:#f9f9f9;
  --muted:#555;
  --accent:#10b981;
  --bubble:#eaeaea;
  --bubble-user:#10b981;
  --bubble-user-text:#fff;
  --bubble-text:#222;
  --link:#10b981;
}
body.dark {
  --bg:#0f172a;
  --card:#1e293b;
  --muted:#94a3b8;
  --accent:#10b981;
  --bubble:#334155;
  --bubble-text:#f1f5f9;
  --bubble-user:#10b981;
  --bubble-user-text:#fff;
  --link:#34d399;
}
*{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
body{
  margin:0;background:var(--bg);color:#222;
  display:flex;align-items:center;justify-content:center;height:100vh;
  transition: background .3s ease, color .3s ease;
}
body.dark{color:#f1f5f9;}
.app{width:100%;max-width:720px;padding:20px}
.card{
  background:var(--card);
  border-radius:12px;
  padding:18px;
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
  transition: background .3s ease;
}
.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.header-left{display:flex;align-items:center;gap:12px}
.logo{
  width:44px;height:44px;border-radius:10px;
  background:linear-gradient(135deg,var(--accent),#7c3aed);
  display:flex;align-items:center;justify-content:center;font-weight:700;color:white;
}
h1{font-size:18px;margin:0}
.theme-toggle{
  background:none;border:0;cursor:pointer;font-size:18px;
}
.messages{
  height:420px;overflow:auto;padding:12px;border-radius:8px;
  background:#fff;margin-bottom:12px;border:1px solid #eee;
  transition: background .3s ease;
}
body.dark .messages{background:#0f172a;border:1px solid #334155;}
.msg{display:flex;margin-bottom:10px}
.msg.user{justify-content:flex-end}
.bubble{
  max-width:78%;padding:10px 14px;border-radius:12px;
  background:var(--bubble);color:var(--bubble-text);line-height:1.4;
}
.msg.user .bubble{background:var(--bubble-user);color:var(--bubble-user-text);}
.controls{display:flex;gap:8px}
input[type=text]{
  flex:1;padding:10px 12px;border-radius:10px;
  border:1px solid #ccc;background:#fff;color:#222;
  transition: background .3s ease,color .3s ease;
}
body.dark input[type=text]{background:#1e293b;border:1px solid #475569;color:#f1f5f9;}
button{
  padding:10px 14px;border-radius:10px;border:0;cursor:pointer;
  background:var(--accent);color:#fff;font-weight:600;
}
.muted{color:var(--muted);font-size:13px;margin-top:8px}
.loader{
  display:inline-block;width:8px;height:8px;border-radius:999px;
  background:#666;margin-left:8px;animation:blink 1s linear infinite;
}
body.dark .loader{background:#f1f5f9;}
@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0.2}}
footer{margin-top:12px;color:var(--muted);font-size:13px;text-align:center}
footer a {
  color: var(--link);
  text-decoration: none;
}
footer a:hover {
  text-decoration: underline;
}
.empty{opacity:0.6;text-align:center;padding:36px 12px}

/* bottom nav bar */
  .bottom-nav {
  display: flex;
  justify-content: space-around;
  margin-top: 16px;
}

.bottom-nav a {
  flex: 1;
  text-align: center;
  text-decoration: none;
  color: var(--accent);
  font-size: 11px;      /* smaller label */
}

.bottom-nav svg {
  display: block;
  margin: 0 auto 4px auto;
  width: 30px;          /* bigger icons */
  height: 30px;
}

.bottom-nav a.whatsapp svg {
  fill: #25D366;        /* keep WhatsApp brand green */
}

</style>
</head>
<body>
<div class="app card">
  <div class="header">
    <div class="header-left">
      <div class="logo">SO</div>
      <div>
        <h1>Stella Online Chat</h1>
        <div class="muted">Connects to Render backend API</div>
      </div>
    </div>
    <button class="theme-toggle" id="themeToggle" title="Toggle theme">üåô</button>
  </div>

  <div id="messages" class="messages">
    <div class="empty">Welcome to Shuang Hor (ÂèåÈπ§) distributor online storeüëã. We offer healthy F&B, Personal/Skin Care and Household products. Get more benefits when you join as a member.</div>
  </div>

  <div class="controls">
    <input id="input" type="text" placeholder="Type your message..." />
    <button id="send">Send</button>
  </div>

  <div id="status" class="muted"></div>

<!-- Bottom navigation -->
<div class="bottom-nav">
  <!-- Menu -->
  <a href="menu.html" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="4" y1="6" x2="20" y2="6"/>
      <line x1="4" y1="12" x2="20" y2="12"/>
      <line x1="4" y1="18" x2="20" y2="18"/>
    </svg>
    <span>Menu</span>
  </a>

  <!-- Cart -->
  <a href="cart.html" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="9" cy="21" r="1"/>
      <circle cx="20" cy="21" r="1"/>
      <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
    </svg>
    <span>Cart</span>
  </a>

  <!-- WhatsApp (official logo with white outline) -->
<a href="https://wa.me/60168101358?text=Hello%2C%20I%20am%20contacting%20you%20from%20Customer%20Service%20Chat" 
   target="_blank" class="btn">
  <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 32 32">
    <!-- White circle background -->
    <circle cx="16" cy="16" r="16" fill="#25D366"/>
    <path fill="#FFF" d="M16 3C8.832 3 3 8.832 3 16c0 2.306.576 4.541 1.673 6.53L3 29l6.65-1.746A12.98 12.98 0 0 0 16 29c7.168 0 13-5.832 13-13S23.168 3 16 3zm0 23c-2.163 0-4.29-.585-6.142-1.693l-.44-.259-3.946 1.036 1.055-3.85-.287-.456A10.96 10.96 0 0 1 5 16c0-6.063 4.937-11 11-11s11 4.937 11 11-4.937 11-11 11zm5.997-7.722c-.327-.164-1.94-.957-2.24-1.066-.3-.11-.517-.164-.734.164-.218.327-.84 1.066-1.03 1.284-.19.218-.381.245-.708.082-.327-.164-1.383-.509-2.631-1.622-.972-.868-1.627-1.94-1.817-2.268-.19-.327-.02-.509.144-.673.148-.148.327-.382.491-.573.163-.19.218-.327.327-.545.11-.218.055-.409-.027-.573-.082-.164-.736-1.774-1.01-2.431-.265-.64-.536-.553-.736-.563l-.645-.01c-.218 0-.573.082-.873.382s-1.147 1.12-1.147 2.73c0 1.61 1.172 3.167 1.336 3.385.164.218 2.321 3.54 5.633 4.965.787.34 1.398.545 1.877.696.79.25 1.51.215 2.08.136.634-.095 1.94-.793 2.21-1.557.272-.763.272-1.418.19-1.557-.082-.136-.3-.218-.627-.382z"/>
  </svg>
  <span>WhatsApp</span>
</a>
</div>

  <footer>
  ¬© 2025 Customer Service Chat ¬∑ All Rights Reserved ¬∑ 
  <a href="privacy.html">Privacy Policy</a> ¬∑ 
  <a href="terms.html">Terms&nbsp;of&nbsp;Service</a>
</footer>
  
</div>

<script>
const BACKEND_URL = 'https://customer-service-qbwg.onrender.com';
const CHAT_ENDPOINT = BACKEND_URL + '/api/chat';

const messagesEl = document.getElementById('messages');
const inputEl = document.getElementById('input');
const sendBtn = document.getElementById('send');
const statusEl = document.getElementById('status');
const themeToggle = document.getElementById('themeToggle');

function appendMessage(text, sender='bot'){
  const empty = messagesEl.querySelector('.empty'); if(empty) empty.remove();
  const m = document.createElement('div'); m.className = 'msg ' + (sender==='user'?'user':'bot');
  const b = document.createElement('div'); b.className = 'bubble'; b.textContent = text;
  m.appendChild(b); messagesEl.appendChild(m);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function setStatus(text, loading=false){
  statusEl.textContent = text || '';
  if(loading){
    const loader = document.createElement('span'); loader.className='loader'; statusEl.appendChild(loader);
  }
}

async function sendMessage(){
  const text = inputEl.value.trim(); if(!text) return;
  appendMessage(text, 'user'); inputEl.value = ''; inputEl.focus();
  setStatus('Sending...', true);
  try{
    const res = await fetch(CHAT_ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: text })
    });
    if(!res.ok){ const errText = await res.text(); throw new Error(errText || res.statusText); }
    const data = await res.json();
    const reply = (data && (data.reply || data.response || data.answer)) || JSON.stringify(data);
    appendMessage(reply, 'bot'); setStatus('');
  }catch(err){
    console.error(err);
    appendMessage('Error: ' + (err.message||'Failed to reach backend'), 'bot');
    setStatus('Error communicating with backend');
  }
}

sendBtn.addEventListener('click', sendMessage);
inputEl.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') sendMessage(); });

(async function healthCheck(){
  try{
    const res = await fetch(BACKEND_URL + '/health');
    if(res.ok) setStatus('Backend online'); else setStatus('Backend reachable but returned ' + res.status);
  }catch(e){ setStatus('Backend unreachable (check CORS and URL)'); }
})();

// Theme toggle
themeToggle.addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
});

// Load saved theme
(function(){
  const saved = localStorage.getItem('theme');
  if(saved === 'dark'){
    document.body.classList.add('dark');
    themeToggle.textContent = '‚òÄÔ∏è';
  }
})();
</script>
</body>
</html>
