<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout - CEO Products</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { background:#f4ecd6; font-family:Segoe UI, Arial, sans-serif; margin:0; }
    .container { padding:20px; max-width:800px; margin:auto; }
    .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
    .summary { background:#fffbe6; padding:16px; border-radius:16px; margin-bottom:20px; }
    .summary h3 { margin:0 0 12px; color:#996600; }
    .item { border-bottom:1px solid #ddd; padding:8px 0; }
    .item:last-child { border-bottom:none; }
    .total { font-size:1.2rem; font-weight:bold; margin-top:12px; }
    .payment, .delivery { background:#fff; padding:16px; border-radius:12px; margin-top:20px; }
    .payment h3, .delivery h3 { margin-top:0; }
    .qr-container { display:flex; gap:20px; flex-wrap:wrap; margin-top:12px; }
    .qr-box { text-align:center; }
    .qr-box img { width:150px; height:150px; border:1px solid #ccc; border-radius:8px; }
    .btn { display:block; margin-top:20px; padding:12px; background:#14b47e; color:#fff; border:none; border-radius:8px; font-size:1rem; text-align:center; cursor:pointer; }
    .btn:hover { background:#11996a; }
    .link-btn { text-decoration:none; background:#996600; color:#fff; padding:8px 16px; border-radius:8px; }
    .form-group { margin-bottom:12px; }
    label { display:block; margin-bottom:4px; font-weight:500; }
    input, textarea { width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; font-size:1rem; }
    textarea { resize:vertical; min-height:80px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2>‚úÖ Checkout</h2>
      <a href="cart.html" class="link-btn">‚¨Ö Back to Cart</a>
    </div>

    <!-- Order Summary -->
    <div class="summary" id="order-summary"></div>

    <!-- Delivery Details -->
    <div class="delivery">
      <h3>Delivery Details</h3>
      <div class="form-group">
        <label for="name">Full Name</label>
        <input type="text" id="name" placeholder="Enter your full name">
      </div>
      <div class="form-group">
        <label for="phone">Phone Number</label>
        <input type="text" id="phone" placeholder="e.g. 0123456789">
      </div>
      <div class="form-group">
        <label for="address">Delivery Address</label>
        <textarea id="address" placeholder="Enter full address"></textarea>
      </div>
    </div>

    <!-- Payment Options -->
    <div class="payment">
      <h3>Payment Options</h3>
      <p>Scan one of the QR codes below to make payment:</p>
      <div class="qr-container">
        <div class="qr-box">
          <p>üè¶ Bank QR</p>
          <img src="img/bank_qr.png" alt="Bank QR">
        </div>
        <div class="qr-box">
          <p>üü¶ Touch 'n Go</p>
          <img src="img/tng_qr.png" alt="Touch n Go QR">
        </div>
      </div>
    </div>

    <!-- Confirm -->
    <button class="btn" onclick="confirmOrder()">Confirm Order</button>
  </div>

  <script>
    let cart = JSON.parse(localStorage.getItem("cartItems")) || [];
    const SHIPPING_FEE = 10; // flat shipping fee

    function renderSummary() {
      let summary = document.getElementById("order-summary");
      if(cart.length === 0) {
        summary.innerHTML = "<p>Your cart is empty.</p>";
        return;
      }

      let html = "<h3>Order Summary</h3>";
      let total = 0;
      cart.forEach(item => {
        let subtotal = item.price * item.qty;
        total += subtotal;
        html += `
          <div class="item">
            ${item.name} - RM ${item.price} √ó ${item.qty} = RM ${subtotal}
          </div>
        `;
      });

      html += `<div class="item">Shipping Fee: RM ${SHIPPING_FEE}</div>`;
      let grandTotal = total + SHIPPING_FEE;
      html += `<div class="total">Grand Total: RM ${grandTotal}</div>`;

      summary.innerHTML = html;
    }

    function confirmOrder() {
      if(cart.length === 0) {
        alert("Your cart is empty!");
        return;
      }

      let name = document.getElementById("name").value.trim();
      let phone = document.getElementById("phone").value.trim();
      let address = document.getElementById("address").value.trim();

      if(!name || !phone || !address) {
        alert("‚ö† Please fill in all delivery details.");
        return;
      }

      let orderDetails = {
        customer: { name, phone, address },
        items: cart,
        shippingFee: SHIPPING_FEE,
        orderTime: new Date().toLocaleString()
      };

      // For now, store in localStorage (later can be sent to backend / Firebase)
      localStorage.setItem("lastOrder", JSON.stringify(orderDetails));

      alert("‚úÖ Thank you! Your order has been placed.");
      localStorage.removeItem("cartItems"); // clear cart
      window.location.href = "shop.html"; // back to shop
    }

    renderSummary();
  </script>

  <!-- ‚¨áÔ∏è 2nd script: shared cart counter logic -->
  <script src="js/cart-utils.js"></script>
  
</body>
</html>
